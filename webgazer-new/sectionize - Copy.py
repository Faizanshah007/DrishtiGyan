from selenium import webdriver
from selenium.webdriver.chrome.options import Options
#import os
import pyautogui
import pygetwindow as gw
import pythoncom, PyHook3
import threading


unlock = (False, False)
def uMad_mouse(event):
    global unlock
    return True#unlock[0]

def uMad_keyboard(event):
    global unlock
    return True#unlock[1]

def main_PyHook3():
    hm = PyHook3.HookManager()
    hm.MouseAll = uMad_mouse
    hm.KeyAll = uMad_keyboard
    hm.HookMouse()
    pyautogui.press('esc', presses=10)  # Close any open system tray object
    hm.HookKeyboard()
    pythoncom.PumpMessages()
    
threading.Thread(target = main_PyHook3).start()

chrome_options = Options()
chrome_options.add_argument("--use-fake-ui-for-media-stream")

wd = webdriver.Chrome(options=chrome_options)

pyautogui.FAILSAFE = False

mywindow = gw.getWindowsWithTitle('data:, ')[0]
mywindow_hWnd = mywindow._hWnd

mywindow.activate()

unlock = (False, True)
pyautogui.press('tab',presses=3)
pyautogui.press('enter')
pyautogui.press('f11') #fullscreen
unlock = (False, False)


## wd.fullscreen_window() #Better view

def run_mode():
    global wd
    with open("jquery.min.js","r") as jquery_js, open("js/webgazer.js","r") as webgazer_js, open("simpleheat.js","r") as simpleheat_js:
        jquery = jquery_js.read()
        webgazer = webgazer_js.read()
        simpleheat = simpleheat_js.read()
        wd.execute_script(jquery)
        wd.execute_script(webgazer)
        wd.execute_script(simpleheat)
        
        wd.execute_script('''//console.log = function() {};
        window.wrk_mode = (window.location.href).slice(-1);

        //$( "<canvas id='canvas_1'></canvas>" ).appendTo( "body" );
        
        
        if(window.wrk_mode == 1)
        {webgazer.showPredictionPoints(0); // 0 to hide
        $(document).ready(function () {
        //console.log(window.innerWidth, window.innerHeight);
        var Hcount = 0;
        var Pcount = 0;
        $( "h1, h2, h3, h4, h5, h6, p" ).each(function( index ) {
        if($(this).is("p"))
        {++Pcount;
        var temp_str = ("<label style = 'opacity:0.0;' class = 'word'>" + $( this ).text().replace(new RegExp(" ", "g"), "</label> <label style = 'opacity:0.0;' class = 'word'>") + "</label>");
        $( this ).text('');
        $(temp_str).appendTo($( this ));
        $( this ).attr('id', 'para'+Hcount+'-'+Pcount);
        $( this ).attr('class', 'paragraph');
        $( this ).attr('style', 'border:1px solid black;padding:25px;'); //black
        }
        else{
        ++Hcount;
        Pcount = 0;
        var temp_str = ("<label style = 'opacity:0.0;' class = 'word'>" + $( this ).text().replace(new RegExp(" ", "g"), "</label> <label style = 'opacity:0.0;' class = 'word'>") + "</label>");
        $( this ).text('');
        $(temp_str).appendTo($( this ));
        $( this ).attr('id', 'head'+Hcount);
        $( this ).attr('class', 'heading');
        $( this ).attr('style', 'border:1px solid blue;padding:25px;');} //blue
        });

        $(".word").mouseover(function() {
            //console.log( $( this ).text(), $( this ).parent().attr('id'), Date.now(), "- cursor");
        });
        });

        function getGazedElement(x,y)
        {
            var ele = document.elementFromPoint(x, y);
            if(ele.className == "word");
                //console.log(ele.textContent, "parent:", ele.parentNode.id, Date.now(), "- gaze");
        }
        ///////////////////////////////////////////////////////////////
        
        ///////////////////////////////////////////////////////////////
        }

        else{
                window.go_to_main_page = false;
                $("body").empty();
                $("html").append('<style>html{ background: url(ket.png) no-repeat center center fixed; -webkit-background-size: cover;-moz-background-size: cover; -o-background-size: cover;background-size: cover;} </style>');
                webgazer.showPredictionPoints(1); // 1 to show
        }
        
        
        /*webgazer.setGazeListener(function(data, elapsedTime) {
            if (data == null) {
                return;
            }
            var xprediction = data.x; //these x coordinates are relative to the viewport
            var yprediction = data.y; //these y coordinates are relative to the viewport
            //console.log(elapsedTime); //elapsed time is based on time since begin was called
        });*/
        ////////////////////////////////////////////////////////
        if(window.wrk_mode == 1)
        {webgazer.params.showVideo = false;
        webgazer.params.showFaceOverlay = false;
        webgazer.params.showFaceFeedbackBox = false;} //Change Here
        //////////////////////////////////////////////////////
        webgazer.begin();

        function checkIfReady() {
                if (webgazer.isReady()) {
                    webgazer.removeMouseEventListeners();
                } else {
                    setTimeout(checkIfReady, 0);
                }
            }
        if(window.wrk_mode == 1)
        {setTimeout(checkIfReady,0);}//////////////////////////////

        flag = 0;

        
        $(document).keydown(function(e) {
          if (e.keyCode === 27) {
          webgazer.end();
          if(window.wrk_mode == 1)
              {
                  clearInterval(loopCall); //console.log(heat);
                  $.ajax({
                    type: "POST",
                    url: "run.php" ,
                    data: {'g':JSON.stringify(heat)}
                    });
              }////////////////////////////
          else
              {setTimeout(function(){window.go_to_main_page = true;}, 5000);}
          }

          if (e.ctrlKey) {
          flag = 1;
          }

          if(flag && e.keyCode === 67) {
          webgazer.clearData();
          if(window.wrk_mode == 1)
              {clearInterval(loopCall);}/////////////////////////////////
          flag = 0;
          }
        });

        function sortProperties(obj)
        {
        // convert object into array
        var sortable=[];
        for(var key in obj)
                if(obj.hasOwnProperty(key))
                        sortable.push([key, obj[key]]); // each item is an array in format [key, value]

        // sort items by value
        sortable.sort(function(a, b)
        {
                var x=a[1], y=b[1];
                return x<y ? -1 : x>y ? 1 : 0;
        });
        return sortable; // array in format [ [ key1, val1 ], [ key2, val2 ], ... ]
        }

        function getprediction() {
            //console.time('start');
            var dict = {};
            for (i=0;i<10;++i) //50
            {
            var prediction = webgazer.getCurrentPrediction();
            if (prediction) {
                    webgazer.util.bound(prediction);
                    var x = prediction.x;
                    var y = prediction.y;
                    //console.log(x,y);
                    if(dict[[x,y]] == undefined)
                            dict[[x,y]] = 1;
                    else
                            dict[[x,y]] += 1;
                    }
            }

            if(Object.keys(dict).length == 0)  //RETURN now itself if no prediction
                    return;

            sortlst = sortProperties(dict);
            if((sortlst[sortlst.length - 1])[1] > 11)
            {
                    var res = (sortlst[sortlst.length - 1])[0].split(",");
                    var avg = [parseInt(res[0]),parseInt(res[1])];
                    var i = sortlst.length - 1;
                    while(i>0 && ((sortlst[i-1])[1] == (sortlst[sortlst.length - 1])[1]))
                    {
                            console.log('- Mode AVG ');
                            --i;
                            var temp = (sortlst[i])[0].split(",");
                            avg[0] += parseInt(temp[0]);
                            avg[1] += parseInt(temp[1]);
                    }
                    var deno = sortlst.length - i;
                    avg[0] = Math.round(avg[0] / deno);
                    avg[1] = Math.round(avg[1] / deno);
                    console.log(avg[0], avg[1], '- Mode', Date.now());
                    //console.timeLog('start');
                    getGazedElement(avg[0],avg[1]);
                    //console.timeLog('start');
                    heatmap(avg[0],avg[1]);
                    //console.timeEnd('start');
            }
            else {
                    var avg = [0,0];
                    var tot = 0;
                    for(var i = sortlst.length - 1; i >= 0; --i)
                    {
                            var temp = (sortlst[i])[0].split(",");
                            avg[0] += parseInt(temp[0]) * sortlst[i][1];
                            avg[1] += parseInt(temp[1]) * sortlst[i][1];
                            tot += sortlst[i][1];
                    }
                    avg[0] = Math.round(avg[0] / tot);
                    avg[1] = Math.round(avg[1] / tot);
                    console.log(avg[0], avg[1], '- AVG', Date.now());
                    //console.timeLog('start');
                    getGazedElement(avg[0],avg[1]);
                    //console.timeLog('start');
                    heatmap(avg[0],avg[1]);
                    //console.timeEnd('start');
            }
        }

        if(window.wrk_mode == 1)
        {window.loopCall = setInterval(getprediction,1000);}''')

##        wd.execute_script('''var cv = document.getElementById("canvas_1");
##        cv.style.left = "0px";
##        cv.style.top = "0px";
##        //Subtract 17 from _width (scrollbar width)
##        var val = {"_canvas":{},"_ctx":{},"_width":1349,"_height":4831,"_max":18,"_data":[[475,593,1],[368,688,1],[159,672,1],[1145,206,1],[1126,0,1],[182,531,1],[498,368,1],[810,311,1],[692,101,1],[486,444,1],[238,277,1],[146,563,1],[215,659,1],[453,571,1],[976,22,1],[444,576,1],[365,171,1],[719,482,1],[454,443,1],[291,637,1],[77,496,1],[188,517,1],[0,540,1],[596,461,1],[196,463,1],[255,682,1],[272,550,1],[318,694,1],[6,618,1],[544,365,1],[638,577,1],[396,578,1],[307,730,1],[260,613,1],[528,461,1],[269,521,1],[343,549,1],[374,390,1],[247,547,1],[439,394,1],[380,348,1],[356,346,1],[328,789,1],[443,772,1],[392,999,1],[551,501,1],[609,777,1],[551,930,1],[352,964,1],[290,997,1],[310,804,1],[407,802,1],[238,863,1],[382,972,1],[268,1202,1],[532,1557,1],[492,1170,1],[388,1421,1],[714,1528,1],[445,1340,1],[499,1515,1],[266,1621,1],[70,1472,1],[594,1498,1],[517,1899,1],[452,1876,1],[288,1725,1],[297,1871,1],[421,1756,1],[355,1876,1],[408,1910,1],[471,1926,1],[439,1834,1],[545,2161,1],[259,1965,1],[352,2308,1],[550,2143,1],[536,2220,1],[404,1925,1],[386,2286,1],[435,2133,1],[372,2190,1],[414,2381,1],[432,2436,1],[651,2590,1],[261,2653,1],[252,2644,1],[460,2406,1],[356,2543,1],[212,2648,1],[306,2718,1],[303,2605,1],[261,2601,1],[487,2648,1],[509,2676,1],[388,2650,1],[311,3090,1],[523,2828,1],[429,3078,1],[249,3133,1],[382,3106,1],[288,2924,1],[349,2862,1],[413,3019,1],[598,2906,1],[242,2999,1],[454,3216,1],[499,3344,1],[446,3220,1],[330,3250,1],[444,3301,1],[555,3153,1],[322,3261,1],[278,3556,1],[293,3738,1],[264,3628,1],[269,3561,1],[441,3457,1],[307,3611,1],[481,3648,1],[479,3521,1],[290,3555,1],[404,3516,1],[623,3460,1],[438,3533,1],[259,3980,1],[834,3667,1],[335,3731,1],[386,3861,1],[407,3835,1],[311,4006,1],[596,3881,1],[226,3996,1],[89,3891,1],[449,3975,1],[301,4126,1],[384,4317,1],[268,4172,1],[539,4196,1],[501,4248,1],[425,4078,1],[371,4405,1],[377,4195,1],[579,4195,1],[356,4255,1],[271,4150,1],[307,4244,1],[526,4228,1],[318,4313,1],[346,4234,1],[614,4447,1],[426,4310,1],[395,4329,1],[196,4451,1],[307,4388,1],[158,4463,1],[542,4415,1],[202,4484,1],[284,4680,1],[422,4408,1],[379,4398,1],[398,4532,1],[445,4531,1]],"_grad":{"0":0,"1":0,"2":255,"3":255,"4":0,"5":0,"6":255,"7":255,"8":0,"9":0,"10":255,"11":255,"12":0,"13":0,"14":255,"15":255,"16":0,"17":0,"18":255,"19":255,"20":0,"21":0,"22":255,"23":255,"24":0,"25":0,"26":255,"27":255,"28":0,"29":0,"30":255,"31":255,"32":0,"33":0,"34":255,"35":255,"36":0,"37":0,"38":255,"39":255,"40":0,"41":0,"42":255,"43":255,"44":0,"45":0,"46":255,"47":255,"48":0,"49":0,"50":255,"51":255,"52":0,"53":0,"54":255,"55":255,"56":0,"57":0,"58":255,"59":255,"60":0,"61":0,"62":255,"63":255,"64":0,"65":0,"66":255,"67":255,"68":0,"69":0,"70":255,"71":255,"72":0,"73":0,"74":255,"75":255,"76":0,"77":0,"78":255,"79":255,"80":0,"81":0,"82":255,"83":255,"84":0,"85":0,"86":255,"87":255,"88":0,"89":0,"90":255,"91":255,"92":0,"93":0,"94":255,"95":255,"96":0,"97":0,"98":255,"99":255,"100":0,"101":0,"102":255,"103":255,"104":255,"105":0,"106":0,"107":255,"108":255,"109":0,"110":0,"111":255,"112":255,"113":0,"114":0,"115":255,"116":255,"117":0,"118":0,"119":255,"120":255,"121":0,"122":0,"123":255,"124":255,"125":0,"126":0,"127":255,"128":255,"129":0,"130":0,"131":255,"132":255,"133":0,"134":0,"135":255,"136":255,"137":0,"138":0,"139":255,"140":255,"141":0,"142":0,"143":255,"144":255,"145":0,"146":0,"147":255,"148":255,"149":0,"150":0,"151":255,"152":255,"153":0,"154":0,"155":255,"156":255,"157":0,"158":0,"159":255,"160":255,"161":0,"162":0,"163":255,"164":255,"165":0,"166":0,"167":255,"168":255,"169":0,"170":0,"171":255,"172":255,"173":0,"174":0,"175":255,"176":255,"177":0,"178":0,"179":255,"180":255,"181":0,"182":0,"183":255,"184":255,"185":0,"186":0,"187":255,"188":255,"189":0,"190":0,"191":255,"192":255,"193":0,"194":0,"195":255,"196":255,"197":0,"198":0,"199":255,"200":255,"201":0,"202":0,"203":255,"204":255,"205":0,"206":0,"207":255,"208":255,"209":0,"210":0,"211":255,"212":255,"213":0,"214":0,"215":255,"216":255,"217":0,"218":0,"219":255,"220":255,"221":0,"222":0,"223":255,"224":255,"225":0,"226":0,"227":255,"228":255,"229":0,"230":0,"231":255,"232":255,"233":0,"234":0,"235":255,"236":255,"237":0,"238":0,"239":255,"240":255,"241":0,"242":0,"243":255,"244":255,"245":0,"246":0,"247":255,"248":255,"249":0,"250":0,"251":255,"252":255,"253":0,"254":0,"255":255,"256":255,"257":0,"258":0,"259":255,"260":255,"261":0,"262":0,"263":255,"264":255,"265":0,"266":0,"267":255,"268":255,"269":0,"270":0,"271":255,"272":255,"273":0,"274":0,"275":255,"276":255,"277":0,"278":0,"279":255,"280":255,"281":0,"282":0,"283":255,"284":255,"285":0,"286":0,"287":255,"288":255,"289":0,"290":0,"291":255,"292":255,"293":0,"294":0,"295":255,"296":255,"297":0,"298":0,"299":255,"300":255,"301":0,"302":0,"303":255,"304":255,"305":0,"306":0,"307":255,"308":255,"309":0,"310":0,"311":255,"312":255,"313":0,"314":0,"315":255,"316":255,"317":0,"318":0,"319":255,"320":255,"321":0,"322":0,"323":255,"324":255,"325":0,"326":0,"327":255,"328":255,"329":0,"330":0,"331":255,"332":255,"333":0,"334":0,"335":255,"336":255,"337":0,"338":0,"339":255,"340":255,"341":0,"342":0,"343":255,"344":255,"345":0,"346":0,"347":255,"348":255,"349":0,"350":0,"351":255,"352":255,"353":0,"354":0,"355":255,"356":255,"357":0,"358":0,"359":255,"360":255,"361":0,"362":0,"363":255,"364":255,"365":0,"366":0,"367":255,"368":255,"369":0,"370":0,"371":255,"372":255,"373":0,"374":0,"375":255,"376":255,"377":0,"378":0,"379":255,"380":255,"381":0,"382":0,"383":255,"384":255,"385":0,"386":0,"387":255,"388":255,"389":0,"390":0,"391":255,"392":255,"393":0,"394":0,"395":255,"396":255,"397":0,"398":0,"399":255,"400":255,"401":0,"402":0,"403":255,"404":255,"405":0,"406":0,"407":255,"408":255,"409":0,"410":0,"411":255,"412":255,"413":0,"414":0,"415":255,"416":255,"417":0,"418":0,"419":255,"420":255,"421":0,"422":0,"423":255,"424":255,"425":0,"426":0,"427":255,"428":255,"429":0,"430":0,"431":255,"432":255,"433":0,"434":0,"435":255,"436":255,"437":0,"438":0,"439":255,"440":255,"441":0,"442":0,"443":255,"444":255,"445":0,"446":0,"447":255,"448":255,"449":0,"450":0,"451":255,"452":255,"453":0,"454":0,"455":255,"456":255,"457":0,"458":0,"459":255,"460":255,"461":0,"462":0,"463":255,"464":255,"465":0,"466":0,"467":255,"468":255,"469":0,"470":0,"471":255,"472":255,"473":0,"474":0,"475":255,"476":255,"477":0,"478":0,"479":255,"480":255,"481":0,"482":0,"483":255,"484":255,"485":0,"486":0,"487":255,"488":255,"489":0,"490":0,"491":255,"492":255,"493":0,"494":0,"495":255,"496":255,"497":0,"498":0,"499":255,"500":255,"501":0,"502":0,"503":255,"504":255,"505":0,"506":0,"507":255,"508":255,"509":0,"510":0,"511":255,"512":255,"513":0,"514":0,"515":255,"516":255,"517":0,"518":0,"519":255,"520":255,"521":0,"522":0,"523":255,"524":255,"525":0,"526":0,"527":255,"528":255,"529":0,"530":0,"531":255,"532":255,"533":0,"534":0,"535":255,"536":255,"537":0,"538":0,"539":255,"540":255,"541":0,"542":0,"543":255,"544":255,"545":0,"546":0,"547":255,"548":255,"549":0,"550":0,"551":255,"552":255,"553":0,"554":0,"555":255,"556":255,"557":0,"558":0,"559":255,"560":255,"561":0,"562":0,"563":255,"564":255,"565":0,"566":0,"567":255,"568":255,"569":0,"570":0,"571":255,"572":255,"573":0,"574":0,"575":255,"576":255,"577":0,"578":0,"579":255,"580":255,"581":0,"582":0,"583":255,"584":255,"585":0,"586":0,"587":255,"588":255,"589":0,"590":0,"591":255,"592":255,"593":0,"594":0,"595":255,"596":255,"597":0,"598":0,"599":255,"600":255,"601":0,"602":0,"603":255,"604":255,"605":0,"606":0,"607":255,"608":255,"609":0,"610":0,"611":255,"612":255,"613":0,"614":0,"615":255,"616":255,"617":0,"618":0,"619":255,"620":255,"621":0,"622":0,"623":255,"624":255,"625":0,"626":0,"627":255,"628":255,"629":0,"630":0,"631":255,"632":255,"633":0,"634":0,"635":255,"636":255,"637":0,"638":0,"639":255,"640":255,"641":0,"642":0,"643":255,"644":255,"645":0,"646":0,"647":255,"648":255,"649":0,"650":0,"651":255,"652":255,"653":0,"654":0,"655":255,"656":255,"657":0,"658":0,"659":255,"660":255,"661":0,"662":0,"663":255,"664":255,"665":0,"666":0,"667":255,"668":255,"669":0,"670":0,"671":255,"672":255,"673":0,"674":0,"675":255,"676":255,"677":0,"678":0,"679":255,"680":255,"681":0,"682":0,"683":255,"684":255,"685":0,"686":0,"687":255,"688":255,"689":0,"690":0,"691":255,"692":255,"693":0,"694":0,"695":255,"696":255,"697":0,"698":0,"699":255,"700":255,"701":0,"702":0,"703":255,"704":255,"705":0,"706":0,"707":255,"708":255,"709":0,"710":0,"711":255,"712":255,"713":0,"714":0,"715":255,"716":255,"717":0,"718":0,"719":255,"720":255,"721":0,"722":0,"723":255,"724":255,"725":0,"726":0,"727":255,"728":255,"729":0,"730":0,"731":255,"732":255,"733":0,"734":0,"735":255,"736":255,"737":0,"738":0,"739":255,"740":255,"741":0,"742":0,"743":255,"744":255,"745":0,"746":0,"747":255,"748":255,"749":0,"750":0,"751":255,"752":255,"753":0,"754":0,"755":255,"756":255,"757":0,"758":0,"759":255,"760":255,"761":0,"762":0,"763":255,"764":255,"765":0,"766":0,"767":255,"768":255,"769":0,"770":0,"771":255,"772":255,"773":0,"774":0,"775":255,"776":255,"777":0,"778":0,"779":255,"780":255,"781":0,"782":0,"783":255,"784":255,"785":0,"786":0,"787":255,"788":255,"789":0,"790":0,"791":255,"792":255,"793":0,"794":0,"795":255,"796":255,"797":0,"798":0,"799":255,"800":255,"801":0,"802":0,"803":255,"804":255,"805":0,"806":0,"807":255,"808":255,"809":0,"810":0,"811":255,"812":255,"813":0,"814":0,"815":255,"816":255,"817":0,"818":0,"819":255,"820":255,"821":0,"822":0,"823":255,"824":255,"825":0,"826":0,"827":255,"828":255,"829":0,"830":0,"831":255,"832":255,"833":0,"834":0,"835":255,"836":255,"837":0,"838":0,"839":255,"840":255,"841":0,"842":0,"843":255,"844":255,"845":0,"846":0,"847":255,"848":255,"849":0,"850":0,"851":255,"852":255,"853":0,"854":0,"855":255,"856":255,"857":0,"858":0,"859":255,"860":255,"861":0,"862":0,"863":255,"864":255,"865":0,"866":0,"867":255,"868":255,"869":0,"870":0,"871":255,"872":255,"873":0,"874":0,"875":255,"876":255,"877":0,"878":0,"879":255,"880":255,"881":0,"882":0,"883":255,"884":255,"885":0,"886":0,"887":255,"888":255,"889":0,"890":0,"891":255,"892":255,"893":0,"894":0,"895":255,"896":255,"897":0,"898":0,"899":255,"900":255,"901":0,"902":0,"903":255,"904":255,"905":0,"906":0,"907":255,"908":255,"909":0,"910":0,"911":255,"912":255,"913":0,"914":0,"915":255,"916":255,"917":0,"918":0,"919":255,"920":255,"921":0,"922":0,"923":255,"924":255,"925":0,"926":0,"927":255,"928":255,"929":0,"930":0,"931":255,"932":255,"933":0,"934":0,"935":255,"936":255,"937":0,"938":0,"939":255,"940":255,"941":0,"942":0,"943":255,"944":255,"945":0,"946":0,"947":255,"948":255,"949":0,"950":0,"951":255,"952":255,"953":0,"954":0,"955":255,"956":255,"957":0,"958":0,"959":255,"960":255,"961":0,"962":0,"963":255,"964":255,"965":0,"966":0,"967":255,"968":255,"969":0,"970":0,"971":255,"972":255,"973":0,"974":0,"975":255,"976":255,"977":0,"978":0,"979":255,"980":255,"981":0,"982":0,"983":255,"984":255,"985":0,"986":0,"987":255,"988":255,"989":0,"990":0,"991":255,"992":255,"993":0,"994":0,"995":255,"996":255,"997":0,"998":0,"999":255,"1000":255,"1001":0,"1002":0,"1003":255,"1004":255,"1005":0,"1006":0,"1007":255,"1008":255,"1009":0,"1010":0,"1011":255,"1012":255,"1013":0,"1014":0,"1015":255,"1016":255,"1017":0,"1018":0,"1019":255,"1020":255,"1021":0,"1022":0,"1023":255}};
##        cv.width = val._width;
##        cv.height = val._height;
##        cv.style.position = "absolute";
##        window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
##                                       window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
##        var data = val._data;
##        var heat = simpleheat('canvas_1').data(data).max(18),
##            frame;
##
##        heat._grad = val._grad;
##
##        function draw() {
##            //console.time('draw');
##            heat.draw();
##            //console.timeEnd('draw');
##            frame = null;
##        }
##
##        draw();
##
##        function heatmap(x,y) {
##            heat.add([(x + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft)), (y + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop)), 1]);
##            frame = frame || window.requestAnimationFrame(draw);
##        }''')


webpage = "Modified_From a nation at risk to a democracy at risk_ Educating students for democratic renewal.html"#"9 Compelling Reasons Why Students Should Study Abroad[~].html"
#wd.get(os.path.join(os.getcwd(), webpage))
wd.get("http://localhost/webgazer-new/webpages/" + webpage + "?1")
run_mode()
unlock = (True, True)
pyautogui.moveTo(0,0)
##while(not wd.execute_script("return window.go_to_main_page")):
##    pass
##wd.get("http://localhost/webgazer-new/webpages/" + webpage + "?1")
##run_mode()

